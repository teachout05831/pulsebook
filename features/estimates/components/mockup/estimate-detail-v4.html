<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Estimate Detail V4 — With Page Preview</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <style>
    * { box-sizing: border-box; }
    body { font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif; background: #f8fafc; margin: 0; color: #1e293b; }
    .card { background: white; border: 1px solid #e2e8f0; border-radius: 0.75rem; }
    .card-pad { padding: 1rem 1.25rem; }
    .fi { display: flex; align-items: center; justify-content: space-between; padding: 0.4rem 0; font-size: 0.8125rem; }
    .fi-label { color: #64748b; font-weight: 500; }
    .fi select { border: none; background: none; color: #2563eb; font-size: 0.8125rem; font-weight: 500; cursor: pointer; text-align: right; }
    .btn-sm { font-size: 0.75rem; font-weight: 500; padding: 0.375rem 0.75rem; border-radius: 0.375rem; cursor: pointer; display: inline-flex; align-items: center; gap: 0.375rem; transition: all 0.15s; border: none; }
    .btn-blue { background: #2563eb; color: white; }
    .btn-blue:hover { background: #1d4ed8; }
    .btn-green { background: #16a34a; color: white; }
    .btn-green:hover { background: #15803d; }
    .btn-out { background: white; color: #475569; border: 1px solid #e2e8f0 !important; }
    .btn-out:hover { background: #f1f5f9; }
    .ico-btn { width: 36px; height: 36px; display: flex; align-items: center; justify-content: center; border: 1px solid #e2e8f0; border-radius: 0.5rem; background: white; cursor: pointer; }
    .ico-btn:hover { background: #f1f5f9; }
    .sdot { width: 10px; height: 10px; border-radius: 50%; flex-shrink: 0; }
    .total-bar { background: #1e40af; color: white; border-radius: 0 0 0.75rem 0.75rem; padding: 0.75rem 1.25rem; margin-top: -1px; }
    .pr { display: flex; justify-content: space-between; padding: 0.375rem 0; font-size: 0.8125rem; }
    .pr a { color: #2563eb; text-decoration: none; }
    .pr .dash { color: #cbd5e1; }
    .tabs-notes { display: flex; gap: 0; border-bottom: 1px solid #e2e8f0; }
    .tab-note { padding: 0.625rem 1rem; font-size: 0.8125rem; font-weight: 500; cursor: pointer; color: #94a3b8; border-bottom: 2px solid transparent; margin-bottom: -1px; }
    .tab-note.on { color: #1e293b; border-bottom-color: #1e293b; }
    .fade-in { animation: fadeIn 0.2s ease; }
    @keyframes fadeIn { from { opacity: 0; } to { opacity: 1; } }

    /* Lifecycle bar */
    .lifecycle { display: flex; align-items: center; gap: 0; overflow-x: auto; }
    .lc-step { display: flex; align-items: center; gap: 0; }
    .lc-dot { width: 28px; height: 28px; border-radius: 50%; display: flex; align-items: center; justify-content: center; font-size: 0.625rem; font-weight: 700; flex-shrink: 0; cursor: pointer; transition: all 0.15s; }
    .lc-dot.done { background: #16a34a; color: white; }
    .lc-dot.active { background: #2563eb; color: white; box-shadow: 0 0 0 3px rgba(37,99,235,0.2); }
    .lc-dot.pending { background: #f1f5f9; color: #94a3b8; }
    .lc-dot:hover { transform: scale(1.1); }
    .lc-label { font-size: 0.625rem; font-weight: 500; text-align: center; margin-top: 4px; white-space: nowrap; }
    .lc-label.done { color: #16a34a; }
    .lc-label.active { color: #2563eb; font-weight: 600; }
    .lc-label.pending { color: #94a3b8; }
    .lc-line { width: 32px; height: 2px; flex-shrink: 0; }
    .lc-line.done { background: #16a34a; }
    .lc-line.pending { background: #e2e8f0; }
    .lc-col { display: flex; flex-direction: column; align-items: center; }

    /* Mode toggle */
    .mode-toggle { display: flex; background: #f1f5f9; border-radius: 0.5rem; padding: 3px; }
    .mode-btn { padding: 0.5rem 1rem; font-size: 0.8125rem; font-weight: 500; border: none; background: none; cursor: pointer; border-radius: 0.375rem; color: #64748b; transition: all 0.15s; }
    .mode-btn.on { background: white; color: #1e293b; box-shadow: 0 1px 3px rgba(0,0,0,0.1); }

    /* Page preview */
    .preview-frame { border: 1px solid #e2e8f0; border-radius: 0.75rem; overflow: hidden; background: #f8fafc; }
    .preview-toolbar { background: #1e293b; color: white; padding: 0.5rem 1rem; display: flex; align-items: center; justify-content: space-between; font-size: 0.75rem; }
    .section-toggle { display: flex; align-items: center; justify-content: space-between; padding: 0.5rem 0.75rem; border-bottom: 1px solid #f1f5f9; font-size: 0.8125rem; }
    .section-toggle:last-child { border-bottom: none; }
    .toggle-switch { width: 36px; height: 20px; border-radius: 10px; background: #e2e8f0; cursor: pointer; position: relative; transition: background 0.2s; }
    .toggle-switch.on { background: #2563eb; }
    .toggle-switch::after { content: ''; width: 16px; height: 16px; border-radius: 50%; background: white; position: absolute; top: 2px; left: 2px; transition: transform 0.2s; }
    .toggle-switch.on::after { transform: translateX(16px); }

    @media (max-width: 1024px) {
      .layout-3 { grid-template-columns: 1fr !important; }
    }
  </style>
</head>
<body>

  <!-- ===== CUSTOMER PAGE HEADER ===== -->
  <div style="background:white;border-bottom:1px solid #e2e8f0;">
    <div style="max-width:1400px;margin:0 auto;padding:0.75rem 1.5rem;">
      <div class="flex flex-wrap items-center justify-between gap-3">
        <div class="flex items-center gap-3">
          <a href="#" style="color:#64748b;font-size:0.8125rem;text-decoration:none;">&larr;</a>
          <div style="width:36px;height:36px;border-radius:50%;background:#2563eb;color:white;display:flex;align-items:center;justify-content:center;font-weight:700;font-size:0.875rem;">J</div>
          <div>
            <div class="flex items-center gap-2">
              <span style="font-size:1rem;font-weight:700;">John</span>
              <span style="font-size:0.6875rem;background:#dbeafe;color:#2563eb;padding:1px 6px;border-radius:9999px;font-weight:600;">Lead</span>
            </div>
            <div style="font-size:0.6875rem;color:#64748b;">6029030482 &bull; teachout05@gmail.com</div>
          </div>
        </div>
        <div class="flex items-center gap-2">
          <button class="btn-sm btn-out">Edit</button>
          <button class="btn-sm btn-blue">+New Job</button>
        </div>
      </div>
    </div>
  </div>

  <!-- ===== BREADCRUMB + LIFECYCLE BAR ===== -->
  <div style="background:white;border-bottom:1px solid #e2e8f0;">
    <div style="max-width:1400px;margin:0 auto;padding:0.75rem 1.5rem;">
      <div class="flex flex-wrap items-center justify-between gap-4">
        <!-- Left: Breadcrumb -->
        <div style="font-size:0.8125rem;display:flex;align-items:center;gap:0.5rem;">
          <a href="#" style="color:#2563eb;text-decoration:none;">Estimates</a>
          <span style="color:#cbd5e1;">/</span>
          <span style="font-weight:600;">EST-001</span>
        </div>

        <!-- Center: Lifecycle -->
        <div class="lifecycle">
          <div class="lc-col">
            <div class="lc-dot done">&#10003;</div>
            <div class="lc-label done">Estimate</div>
          </div>
          <div class="lc-line done"></div>
          <div class="lc-col">
            <div class="lc-dot active">2</div>
            <div class="lc-label active">Page</div>
          </div>
          <div class="lc-line pending"></div>
          <div class="lc-col">
            <div class="lc-dot pending">3</div>
            <div class="lc-label pending">Approved</div>
          </div>
          <div class="lc-line pending"></div>
          <div class="lc-col">
            <div class="lc-dot pending">4</div>
            <div class="lc-label pending">Job</div>
          </div>
          <div class="lc-line pending"></div>
          <div class="lc-col">
            <div class="lc-dot pending">5</div>
            <div class="lc-label pending">Contract</div>
          </div>
          <div class="lc-line pending"></div>
          <div class="lc-col">
            <div class="lc-dot pending">6</div>
            <div class="lc-label pending">Invoice</div>
          </div>
        </div>

        <!-- Right: Actions -->
        <div class="flex items-center gap-2">
          <button class="ico-btn" title="Documents"><svg class="w-4 h-4 text-slate-500" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"/></svg></button>
          <button class="ico-btn" title="History"><svg class="w-4 h-4 text-slate-500" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z"/></svg></button>
          <button class="btn-sm btn-green">Book &darr;</button>
        </div>
      </div>
    </div>
  </div>

  <!-- ===== MODE TOGGLE ===== -->
  <div style="max-width:1400px;margin:0 auto;padding:1rem 1.5rem 0;">
    <div class="flex items-center justify-between">
      <div class="mode-toggle">
        <button class="mode-btn on" id="mode-edit" onclick="switchMode('edit')">Estimate Editor</button>
        <button class="mode-btn" id="mode-preview" onclick="switchMode('preview')">Customer Page Preview</button>
      </div>
      <div style="font-size:0.75rem;color:#64748b;" id="mode-hint">
        Build the estimate — pricing, resources, addresses, notes
      </div>
    </div>
  </div>

  <!-- ===== CONTENT AREA ===== -->
  <div style="max-width:1400px;margin:0 auto;padding:1rem 1.5rem;">

    <!-- ==================== -->
    <!-- MODE 1: ESTIMATE EDITOR (the V3 3-column layout) -->
    <!-- ==================== -->
    <div id="editor-mode" class="fade-in">
      <div class="layout-3" style="display:grid;grid-template-columns:230px 1fr 280px;gap:1rem;align-items:start;">

        <!-- LEFT -->
        <div style="display:flex;flex-direction:column;gap:1rem;">
          <div class="card card-pad">
            <div class="flex items-center justify-between mb-3">
              <span style="font-size:0.8125rem;font-weight:600;">Quote Info</span>
              <span style="font-size:0.6875rem;color:#16a34a;font-weight:500;">Opportunity</span>
            </div>
            <div class="fi"><span class="fi-label">Number</span><span style="font-weight:600;">EST-001</span></div>
            <div class="fi"><span class="fi-label">Type</span><select><option selected>Local</option><option>Long Distance</option></select></div>
            <div class="fi"><span class="fi-label">Source</span><select><option selected>Website</option><option>Referral</option></select></div>
            <div class="fi"><span class="fi-label">Sales</span><select><option selected>Daniela</option></select></div>
            <div class="fi"><span class="fi-label">Estimator</span><select><option>Unassigned</option></select></div>
            <div class="fi"><span class="fi-label">Tags</span><a href="#" style="color:#2563eb;font-size:0.8125rem;font-weight:500;">+</a></div>
            <div class="fi"><span class="fi-label">Lead Status</span><select><option selected>New</option><option>Contacted</option></select></div>
          </div>
          <div class="card card-pad">
            <div class="flex items-center justify-between mb-2">
              <span style="font-size:0.8125rem;font-weight:600;">Tasks</span>
              <a href="#" style="color:#2563eb;font-size:0.75rem;">+</a>
            </div>
            <p style="text-align:center;color:#94a3b8;font-size:0.75rem;padding:0.5rem 0;">No tasks yet</p>
          </div>
        </div>

        <!-- CENTER -->
        <div style="display:flex;flex-direction:column;gap:1rem;">
          <div class="card card-pad">
            <div class="flex items-center justify-between mb-3">
              <span style="font-size:0.875rem;font-weight:600;">Jobs</span>
              <a href="#" style="color:#2563eb;font-size:0.75rem;">+ Add Job</a>
            </div>
            <div style="border:2px dashed #e2e8f0;border-radius:0.5rem;padding:1.25rem;text-align:center;">
              <p style="color:#94a3b8;font-size:0.8125rem;margin:0 0 0.5rem;">No jobs linked yet</p>
              <p style="color:#cbd5e1;font-size:0.6875rem;margin:0;">Book this estimate or customer approves online to create a job</p>
            </div>
          </div>
          <div class="card card-pad">
            <div class="flex items-center gap-3 mb-3">
              <span style="font-size:0.875rem;font-weight:600;">Stops</span>
              <a href="#" style="color:#2563eb;font-size:0.75rem;">+</a>
            </div>
            <div style="display:flex;align-items:center;gap:0.75rem;padding:0.5rem 0;border-bottom:1px solid #f1f5f9;">
              <span class="sdot" style="background:#3b82f6;"></span>
              <span style="font-size:0.8125rem;color:#2563eb;font-weight:500;width:80px;">Origin</span>
              <span style="font-size:0.8125rem;">Phoenix, AZ 85015</span>
            </div>
            <div style="display:flex;align-items:center;gap:0.75rem;padding:0.5rem 0;">
              <span class="sdot" style="background:#16a34a;"></span>
              <span style="font-size:0.8125rem;color:#2563eb;font-weight:500;width:80px;">Destination</span>
              <span style="font-size:0.8125rem;">Phoenix, AZ 85041</span>
            </div>
          </div>
          <div class="card">
            <div class="tabs-notes">
              <div class="tab-note on">Internal</div>
              <div class="tab-note">Customer</div>
              <div class="tab-note">Crew</div>
              <div class="tab-note">Feedback</div>
            </div>
            <div style="padding:1rem 1.25rem;">
              <textarea style="width:100%;min-height:100px;border:1px solid #e2e8f0;border-radius:0.5rem;padding:0.75rem;font-size:0.875rem;resize:vertical;">2 bedroom apartment, 1st to 2nd floor
no appliances, boxes and furniture only</textarea>
            </div>
          </div>
        </div>

        <!-- RIGHT -->
        <div style="display:flex;flex-direction:column;gap:1rem;">
          <div class="card card-pad">
            <div style="font-size:0.8125rem;font-weight:600;margin-bottom:0.75rem;">Resources</div>
            <div style="display:grid;grid-template-columns:repeat(4,1fr);gap:0.5rem;text-align:center;">
              <div style="background:#f8fafc;border-radius:0.375rem;padding:0.5rem;"><div style="font-size:0.625rem;color:#64748b;text-transform:uppercase;">Trucks</div><div style="font-size:1rem;font-weight:700;">1</div></div>
              <div style="background:#f8fafc;border-radius:0.375rem;padding:0.5rem;"><div style="font-size:0.625rem;color:#64748b;text-transform:uppercase;">Team</div><div style="font-size:1rem;font-weight:700;">2</div></div>
              <div style="background:#f8fafc;border-radius:0.375rem;padding:0.5rem;"><div style="font-size:0.625rem;color:#64748b;text-transform:uppercase;">Hours</div><div style="font-size:1rem;font-weight:700;">2h</div></div>
              <div style="background:#f0fdf4;border-radius:0.375rem;padding:0.5rem;"><div style="font-size:0.625rem;color:#16a34a;text-transform:uppercase;">Rate</div><div style="font-size:1rem;font-weight:700;color:#16a34a;">$150/hr</div></div>
            </div>
          </div>
          <div class="card card-pad">
            <div style="display:flex;justify-content:space-between;">
              <div><div style="font-size:0.5625rem;color:#94a3b8;text-transform:uppercase;font-weight:600;">Estimate Type</div><select style="border:none;background:none;font-size:0.8125rem;color:#2563eb;font-weight:500;cursor:pointer;padding:0;"><option selected>Hourly</option><option>Flat Rate</option></select></div>
              <div style="text-align:right;"><div style="font-size:0.5625rem;color:#94a3b8;text-transform:uppercase;font-weight:600;">Binding</div><select style="border:none;background:none;font-size:0.8125rem;color:#2563eb;font-weight:500;cursor:pointer;padding:0;"><option selected>Non-Binding</option></select></div>
            </div>
          </div>
          <div class="card">
            <div class="card-pad">
              <div class="pr"><a href="#">Moving Services</a><span style="font-weight:500;">$300.00</span></div>
              <div class="pr"><a href="#">Trip Fee</a><span style="font-weight:500;">$125.00</span></div>
              <div style="border-top:1px solid #e2e8f0;margin:0.5rem 0;"></div>
              <div class="pr"><span style="font-weight:700;">Balance</span><span style="font-weight:700;">$425.00</span></div>
            </div>
            <div class="total-bar">
              <div style="display:flex;justify-content:space-between;align-items:baseline;">
                <span style="font-weight:600;">Estimated Price:</span>
                <span style="font-size:1.25rem;font-weight:700;">$425.00</span>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>

    <!-- ========================= -->
    <!-- MODE 2: CUSTOMER PAGE PREVIEW -->
    <!-- ========================= -->
    <div id="preview-mode" style="display:none;" class="fade-in">
      <div style="display:grid;grid-template-columns:1fr 280px;gap:1rem;align-items:start;">

        <!-- LEFT: Live Preview of what customer sees -->
        <div class="preview-frame">
          <div class="preview-toolbar">
            <div class="flex items-center gap-2">
              <span style="font-weight:600;">Customer View</span>
              <span style="background:rgba(255,255,255,0.15);padding:1px 6px;border-radius:4px;">Published</span>
            </div>
            <div class="flex items-center gap-2">
              <button class="btn-sm" style="background:rgba(255,255,255,0.15);color:white;border:none;font-size:0.6875rem;">Copy Link</button>
              <button class="btn-sm" style="background:#2563eb;color:white;border:none;font-size:0.6875rem;">Send to Customer</button>
            </div>
          </div>

          <!-- Rendered page preview -->
          <div style="padding:2rem;max-width:680px;margin:0 auto;">

            <!-- Hero -->
            <div id="sec-hero" style="margin-bottom:1.5rem;">
              <div style="background:linear-gradient(135deg,#1e40af,#3b82f6);border-radius:0.75rem;padding:2.5rem 2rem;text-align:center;color:white;">
                <div style="font-size:0.6875rem;text-transform:uppercase;letter-spacing:0.1em;opacity:0.8;margin-bottom:0.25rem;">ARM Moving LLC</div>
                <div style="font-size:0.875rem;opacity:0.9;margin-bottom:1rem;">Your Moving Estimate</div>
                <div style="font-size:2rem;font-weight:700;">$425.00</div>
                <div style="font-size:0.875rem;margin-top:0.5rem;opacity:0.9;">Local Move &bull; 2 Movers &bull; 2 Hours</div>
              </div>
            </div>

            <!-- Trust Badges -->
            <div id="sec-trust" style="margin-bottom:1.5rem;">
              <div style="display:flex;justify-content:center;gap:2rem;padding:1rem 0;">
                <div style="text-align:center;"><div style="font-size:1.25rem;">&#9733;</div><div style="font-size:0.6875rem;color:#64748b;">5-Star Rated</div></div>
                <div style="text-align:center;"><div style="font-size:1.25rem;">&#128274;</div><div style="font-size:0.6875rem;color:#64748b;">Licensed & Insured</div></div>
                <div style="text-align:center;"><div style="font-size:1.25rem;">&#128666;</div><div style="font-size:0.6875rem;color:#64748b;">1000+ Moves</div></div>
              </div>
            </div>

            <!-- Pricing Breakdown -->
            <div id="sec-pricing" style="margin-bottom:1.5rem;">
              <div class="card card-pad">
                <div style="font-size:0.9375rem;font-weight:600;margin-bottom:0.75rem;">Pricing Breakdown</div>
                <div class="pr"><span>Moving Services (2 movers &times; 2 hrs &times; $150/hr)</span><span style="font-weight:500;">$300.00</span></div>
                <div class="pr"><span>Trip Fee</span><span style="font-weight:500;">$125.00</span></div>
                <div style="border-top:1px solid #e2e8f0;margin:0.75rem 0;"></div>
                <div class="pr"><span style="font-weight:700;font-size:1rem;">Total</span><span style="font-weight:700;font-size:1rem;">$425.00</span></div>
              </div>
            </div>

            <!-- About Section -->
            <div id="sec-about" style="margin-bottom:1.5rem;">
              <div class="card card-pad">
                <div style="font-size:0.9375rem;font-weight:600;margin-bottom:0.5rem;">About ARM Moving</div>
                <p style="font-size:0.8125rem;color:#475569;line-height:1.6;margin:0;">We've been serving the Phoenix metro area for over 10 years. Our professional movers are trained, background-checked, and equipped to handle your belongings with care.</p>
              </div>
            </div>

            <!-- Testimonials -->
            <div id="sec-testimonials" style="margin-bottom:1.5rem;">
              <div class="card card-pad">
                <div style="font-size:0.9375rem;font-weight:600;margin-bottom:0.75rem;">What Customers Say</div>
                <div style="font-style:italic;font-size:0.8125rem;color:#475569;border-left:3px solid #2563eb;padding-left:0.75rem;">
                  "Amazing service! The crew showed up on time and handled everything perfectly. Would definitely recommend."
                  <div style="font-style:normal;font-weight:500;margin-top:0.5rem;color:#1e293b;">— Sarah K.</div>
                </div>
              </div>
            </div>

            <!-- Gallery -->
            <div id="sec-gallery" style="margin-bottom:1.5rem;display:none;">
              <div class="card card-pad">
                <div style="font-size:0.9375rem;font-weight:600;margin-bottom:0.75rem;">Our Work</div>
                <div style="display:grid;grid-template-columns:repeat(3,1fr);gap:0.5rem;">
                  <div style="background:#e2e8f0;border-radius:0.375rem;height:80px;"></div>
                  <div style="background:#e2e8f0;border-radius:0.375rem;height:80px;"></div>
                  <div style="background:#e2e8f0;border-radius:0.375rem;height:80px;"></div>
                </div>
              </div>
            </div>

            <!-- FAQ -->
            <div id="sec-faq" style="margin-bottom:1.5rem;display:none;">
              <div class="card card-pad">
                <div style="font-size:0.9375rem;font-weight:600;margin-bottom:0.75rem;">FAQ</div>
                <div style="font-size:0.8125rem;">
                  <div style="font-weight:500;margin-bottom:0.25rem;">What if the move takes longer?</div>
                  <div style="color:#64748b;margin-bottom:0.75rem;">For hourly moves, you're only charged for actual time used.</div>
                  <div style="font-weight:500;margin-bottom:0.25rem;">Do you provide packing materials?</div>
                  <div style="color:#64748b;">Yes! We offer boxes, tape, and bubble wrap at additional cost.</div>
                </div>
              </div>
            </div>

            <!-- Approval -->
            <div id="sec-approval" style="margin-bottom:1.5rem;">
              <div class="card card-pad" style="border-color:#16a34a;border-width:2px;">
                <div style="text-align:center;">
                  <div style="font-size:0.9375rem;font-weight:600;margin-bottom:0.75rem;">Ready to Book Your Move?</div>
                  <div style="display:flex;gap:0.75rem;justify-content:center;margin-bottom:0.75rem;">
                    <button class="btn-sm btn-green" style="padding:0.625rem 2rem;font-size:0.875rem;">Approve & Sign</button>
                    <button class="btn-sm btn-out" style="padding:0.625rem 1.5rem;">Request Changes</button>
                  </div>
                  <div style="font-size:0.6875rem;color:#64748b;">Deposit: $100.00 due upon approval</div>
                </div>
              </div>
            </div>

          </div>
        </div>

        <!-- RIGHT: Section Controls -->
        <div style="display:flex;flex-direction:column;gap:1rem;">
          <!-- Section Toggles -->
          <div class="card">
            <div style="padding:0.75rem 1rem;border-bottom:1px solid #e2e8f0;">
              <div style="font-size:0.8125rem;font-weight:600;">Page Sections</div>
              <div style="font-size:0.6875rem;color:#64748b;">Toggle sections on/off</div>
            </div>
            <div>
              <div class="section-toggle">
                <span>Hero</span>
                <div class="toggle-switch on" onclick="toggleSection(this,'sec-hero')"></div>
              </div>
              <div class="section-toggle">
                <span>Trust Badges</span>
                <div class="toggle-switch on" onclick="toggleSection(this,'sec-trust')"></div>
              </div>
              <div class="section-toggle">
                <span>Pricing</span>
                <div class="toggle-switch on" onclick="toggleSection(this,'sec-pricing')"></div>
              </div>
              <div class="section-toggle">
                <span>About</span>
                <div class="toggle-switch on" onclick="toggleSection(this,'sec-about')"></div>
              </div>
              <div class="section-toggle">
                <span>Testimonials</span>
                <div class="toggle-switch on" onclick="toggleSection(this,'sec-testimonials')"></div>
              </div>
              <div class="section-toggle">
                <span>Gallery</span>
                <div class="toggle-switch" onclick="toggleSection(this,'sec-gallery')"></div>
              </div>
              <div class="section-toggle">
                <span>FAQ</span>
                <div class="toggle-switch" onclick="toggleSection(this,'sec-faq')"></div>
              </div>
              <div class="section-toggle">
                <span>Approval</span>
                <div class="toggle-switch on" onclick="toggleSection(this,'sec-approval')"></div>
              </div>
            </div>
            <div style="padding:0.75rem 1rem;border-top:1px solid #e2e8f0;">
              <button class="btn-sm btn-blue" style="width:100%;justify-content:center;">Open in Page Builder</button>
            </div>
          </div>

          <!-- Quick Settings -->
          <div class="card card-pad">
            <div style="font-size:0.8125rem;font-weight:600;margin-bottom:0.75rem;">Page Settings</div>
            <div class="fi">
              <span class="fi-label">Deposit</span>
              <select><option>$100</option><option>$150</option><option>$200</option><option selected>$100</option></select>
            </div>
            <div class="fi">
              <span class="fi-label">Deposit Type</span>
              <select><option selected>Fixed</option><option>Percentage</option></select>
            </div>
            <div class="fi">
              <span class="fi-label">Expiry</span>
              <span style="color:#2563eb;font-weight:500;font-size:0.8125rem;">Feb 15, 2026</span>
            </div>
            <div class="fi">
              <span class="fi-label">Template</span>
              <select style="border:none;background:none;color:#2563eb;font-size:0.8125rem;font-weight:500;cursor:pointer;"><option selected>Moving Default</option><option>Premium</option><option>Minimal</option></select>
            </div>
          </div>

          <!-- Send Actions -->
          <div class="card card-pad">
            <div style="font-size:0.8125rem;font-weight:600;margin-bottom:0.75rem;">Send</div>
            <div style="display:flex;flex-direction:column;gap:0.5rem;">
              <button class="btn-sm btn-blue" style="width:100%;justify-content:center;">Send via Email</button>
              <button class="btn-sm btn-out" style="width:100%;justify-content:center;">Send via Text</button>
              <button class="btn-sm btn-out" style="width:100%;justify-content:center;">Copy Link</button>
            </div>
          </div>
        </div>
      </div>
    </div>

  </div>

  <!-- Annotation -->
  <div style="max-width:1400px;margin:0 auto;padding:0 1.5rem 2rem;">
    <div style="border:2px dashed #8b5cf6;background:#f5f3ff;border-radius:0.5rem;padding:1rem;margin-top:1rem;">
      <p style="font-size:0.9375rem;font-weight:700;color:#6d28d9;margin:0 0 0.5rem;">V4 Concept — Two modes, one place</p>
      <p style="font-size:0.8125rem;color:#7c3aed;margin:0 0 0.5rem;">
        <b>Estimate Editor</b> = Where the rep works (pricing, resources, addresses, notes) — the V3 layout.<br/>
        <b>Customer Page Preview</b> = What the customer sees — live preview with section toggles and quick settings.
      </p>
      <p style="font-size:0.8125rem;color:#7c3aed;margin:0 0 0.5rem;">
        The <b>lifecycle bar</b> at the top is data-driven — steps light up green as they're completed. Click any step to jump there.
      </p>
      <p style="font-size:0.8125rem;color:#7c3aed;margin:0;">
        <b>The rep never leaves the estimate.</b> Build pricing → flip to preview → toggle sections → send to customer → customer approves → job created. All in one flow.
      </p>
    </div>
  </div>

  <script>
    function switchMode(mode) {
      document.getElementById('editor-mode').style.display = mode === 'edit' ? 'block' : 'none';
      document.getElementById('preview-mode').style.display = mode === 'preview' ? 'block' : 'none';
      document.getElementById('mode-edit').classList.toggle('on', mode === 'edit');
      document.getElementById('mode-preview').classList.toggle('on', mode === 'preview');
      document.getElementById('mode-hint').textContent = mode === 'edit'
        ? 'Build the estimate — pricing, resources, addresses, notes'
        : 'This is what the customer sees — toggle sections, pick template, send';

      // Re-trigger animation
      const el = document.getElementById(mode === 'edit' ? 'editor-mode' : 'preview-mode');
      el.classList.remove('fade-in');
      void el.offsetWidth;
      el.classList.add('fade-in');
    }

    function toggleSection(toggle, sectionId) {
      toggle.classList.toggle('on');
      const section = document.getElementById(sectionId);
      section.style.display = toggle.classList.contains('on') ? 'block' : 'none';
    }
  </script>

</body>
</html>
