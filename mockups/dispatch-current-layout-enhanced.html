<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<title>Dispatch - Technician + Map View (Enhanced)</title>
<style>
  * { margin: 0; padding: 0; box-sizing: border-box; }
  body { font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif; overflow: hidden; height: 100vh; background: #f3f4f6; }

  /* â”€â”€ Header â”€â”€ */
  .header {
    height: 44px; background: #fff; border-bottom: 1px solid #e5e7eb;
    display: flex; align-items: center; padding: 0 12px; gap: 8px;
    position: relative; z-index: 30;
  }
  .header h1 { font-size: 14px; font-weight: 700; color: #111827; white-space: nowrap; }
  .header .sep { width: 1px; height: 20px; background: #e5e7eb; }
  .date-nav { display: flex; align-items: center; gap: 4px; }
  .date-nav button { background: none; border: none; cursor: pointer; font-size: 14px; color: #6b7280; padding: 2px 6px; border-radius: 4px; }
  .date-nav button:hover { background: #f3f4f6; }
  .date-nav span { font-size: 13px; font-weight: 500; color: #374151; }
  .date-nav .day-badge { font-size: 11px; background: #e5e7eb; color: #374151; padding: 1px 8px; border-radius: 4px; font-weight: 500; }
  .stat-dots { display: flex; gap: 4px; align-items: center; }
  .stat-dot { display: flex; align-items: center; gap: 3px; font-size: 11px; font-weight: 600; color: #374151; padding: 2px 6px; border-radius: 4px; cursor: pointer; }
  .stat-dot:hover { background: #f3f4f6; }
  .stat-dot .dot { width: 6px; height: 6px; border-radius: 50%; }
  .header-right { margin-left: auto; display: flex; align-items: center; gap: 6px; }
  .view-dropdown {
    display: flex; align-items: center; gap: 4px; padding: 4px 10px;
    border: 1px solid #d1d5db; border-radius: 6px; font-size: 12px; font-weight: 500;
    background: #fff; cursor: pointer; color: #374151;
  }
  .view-dropdown:hover { background: #f9fafb; }
  .icon-btn {
    width: 32px; height: 32px; border: 1px solid #d1d5db; border-radius: 6px;
    background: #fff; cursor: pointer; display: flex; align-items: center; justify-content: center;
    color: #6b7280; font-size: 14px;
  }
  .icon-btn:hover { background: #f3f4f6; }
  .icon-btn.active { border-color: #3b82f6; background: #eff6ff; color: #2563eb; }
  .add-btn {
    height: 32px; padding: 0 10px; border: none; border-radius: 6px;
    background: #2563eb; color: #fff; font-size: 12px; font-weight: 600;
    cursor: pointer; display: flex; align-items: center; gap: 4px;
  }

  /* â”€â”€ Timeline Area â”€â”€ */
  .timeline-area {
    height: calc(50vh - 22px);
    overflow: hidden; background: #fff;
    transition: height 0.3s ease;
  }
  .timeline-area.map-expanded { height: calc(35vh - 22px); }

  /* Technician rows */
  .tech-list { border-right: 1px solid #e5e7eb; }
  .tech-row {
    display: flex; align-items: center;
    height: 56px; padding: 0 10px; gap: 8px;
    border-bottom: 1px solid #f3f4f6;
  }
  .tech-avatar {
    width: 32px; height: 32px; border-radius: 50%;
    display: flex; align-items: center; justify-content: center;
    color: #fff; font-size: 12px; font-weight: 700; flex-shrink: 0;
  }
  .tech-info { flex: 1; min-width: 0; }
  .tech-name { font-size: 13px; font-weight: 600; color: #111827; }
  .tech-meta { font-size: 11px; color: #9ca3af; }

  /* Time grid */
  .timeline-grid {
    display: flex; flex: 1; overflow-x: auto;
    position: relative;
  }
  .time-headers {
    display: flex; height: 28px; border-bottom: 1px solid #e5e7eb;
    background: #fafafa;
  }
  .time-header {
    min-width: 80px; font-size: 10px; color: #9ca3af; font-weight: 500;
    display: flex; align-items: center; padding-left: 6px;
    border-right: 1px solid #f3f4f6;
  }
  .timeline-content { display: flex; flex: 1; }
  .tech-lane-wrapper { width: 150px; flex-shrink: 0; }
  .grid-area { flex: 1; overflow-x: auto; }
  .grid-row {
    height: 56px; border-bottom: 1px solid #f3f4f6;
    position: relative; display: flex; align-items: center; padding: 0 4px;
  }
  .job-block {
    height: 40px; border-radius: 6px; padding: 4px 8px;
    font-size: 11px; color: #fff; font-weight: 500;
    display: flex; flex-direction: column; justify-content: center;
    cursor: pointer; position: absolute; top: 8px;
    box-shadow: 0 1px 3px rgba(0,0,0,0.1);
    transition: transform 0.15s ease, box-shadow 0.15s ease;
  }
  .job-block:hover { transform: translateY(-1px); box-shadow: 0 3px 8px rgba(0,0,0,0.15); }
  .job-block .job-title { font-weight: 600; white-space: nowrap; overflow: hidden; text-overflow: ellipsis; }
  .job-block .job-sub { font-size: 10px; opacity: 0.8; white-space: nowrap; overflow: hidden; text-overflow: ellipsis; }

  /* Unassigned row */
  .unassigned-row {
    display: flex; height: 40px; background: #fef2f2; border-bottom: 1px solid #fecaca;
    align-items: center; padding: 0 10px; gap: 6px;
  }
  .unassigned-dot { width: 8px; height: 8px; border-radius: 50%; background: #ef4444; }
  .unassigned-label { font-size: 12px; font-weight: 600; color: #dc2626; }
  .unassigned-count { font-size: 11px; color: #f87171; }
  .unassigned-jobs { display: flex; gap: 4px; flex: 1; overflow-x: auto; padding: 0 8px; }
  .unassigned-chip {
    padding: 4px 10px; background: #fff; border: 1px solid #fecaca;
    border-radius: 6px; font-size: 11px; font-weight: 500; color: #374151;
    white-space: nowrap; cursor: pointer;
  }
  .unassigned-chip:hover { background: #fef2f2; }

  /* â”€â”€ Drawer handle â”€â”€ */
  .drawer-handle {
    height: 28px; background: #f9fafb; border-top: 1px solid #e5e7eb;
    display: flex; align-items: center; justify-content: center; gap: 8px;
    cursor: ns-resize; user-select: none;
  }
  .handle-bar { width: 40px; height: 4px; background: #d1d5db; border-radius: 2px; }
  .handle-label { font-size: 11px; color: #6b7280; font-weight: 500; display: flex; align-items: center; gap: 4px; }

  /* â”€â”€ Map Drawer â”€â”€ */
  .map-drawer {
    flex: 1; display: flex; flex-direction: column;
    overflow: hidden;
  }
  .map-content {
    flex: 1; display: flex; overflow: hidden; position: relative;
  }

  /* Map canvas */
  .map-canvas {
    flex: 1; position: relative;
    background: linear-gradient(135deg, #dce8d0 0%, #e2dcc8 30%, #ddd8c6 50%, #d5ddd0 70%, #e0e4d6 100%);
    transition: margin-right 0.35s ease;
  }
  .map-canvas.panel-open { margin-right: 340px; }
  .map-roads { position: absolute; inset: 0; opacity: 0.12; }
  .area-label { position: absolute; font-weight: 500; letter-spacing: 1.5px; color: #777; font-size: 11px; }

  /* Map pins */
  .map-pin {
    position: absolute; cursor: pointer;
    transition: transform 0.2s ease;
    z-index: 2;
  }
  .map-pin:hover { transform: scale(1.15); z-index: 5; }
  .map-pin.selected { transform: scale(1.25); z-index: 10; }
  .pin-svg { width: 28px; height: 34px; }
  .pin-num {
    position: absolute; top: 4px; left: 50%; transform: translateX(-50%);
    font-size: 10px; font-weight: 700; color: #fff;
  }
  .pin-tip {
    position: absolute; bottom: calc(100% + 4px); left: 50%; transform: translateX(-50%);
    background: #1e293b; color: #fff; padding: 4px 8px; border-radius: 4px;
    font-size: 10px; white-space: nowrap;
    opacity: 0; pointer-events: none; transition: opacity 0.15s;
  }
  .map-pin:hover .pin-tip, .map-pin.selected .pin-tip { opacity: 1; }
  .map-pin.selected .pin-tip { background: #2563eb; }
  .map-pin.selected::after {
    content: ''; position: absolute; top: -4px; left: -4px;
    width: 36px; height: 36px; border: 2px solid currentColor; border-radius: 50%;
    animation: pulse 1.5s ease-out infinite;
  }
  @keyframes pulse { 0% { transform: scale(0.8); opacity: 0.8; } 100% { transform: scale(1.6); opacity: 0; } }

  /* Sidebar job list (existing) */
  .map-sidebar {
    width: 240px; background: #fff; border-left: 1px solid #e5e7eb;
    overflow-y: auto; flex-shrink: 0;
    transition: width 0.3s ease;
  }
  .map-sidebar.collapsed { width: 0; overflow: hidden; border: none; }
  .sidebar-title {
    padding: 6px 10px; border-bottom: 1px solid #f3f4f6;
    font-size: 10px; font-weight: 600; color: #9ca3af; text-transform: uppercase;
  }
  .sidebar-group-header {
    display: flex; align-items: center; gap: 6px; padding: 4px 10px;
    background: #fafafa; border-bottom: 1px solid #f3f4f6;
  }
  .sidebar-color { width: 10px; height: 10px; border-radius: 2px; }
  .sidebar-group-name { font-size: 11px; font-weight: 600; }
  .sidebar-group-count { font-size: 10px; color: #9ca3af; margin-left: auto; }
  .sidebar-job {
    display: flex; align-items: center; gap: 8px; padding: 6px 10px;
    border-bottom: 1px solid #f9fafb; cursor: pointer; transition: background 0.1s;
  }
  .sidebar-job:hover { background: #f9fafb; }
  .sidebar-job.active { background: #eff6ff; }
  .sidebar-job-num {
    width: 22px; height: 22px; border-radius: 50%;
    display: flex; align-items: center; justify-content: center;
    color: #fff; font-size: 10px; font-weight: 700; flex-shrink: 0;
  }
  .sidebar-job-info { flex: 1; min-width: 0; }
  .sidebar-job-title { font-size: 12px; font-weight: 500; color: #111827; white-space: nowrap; overflow: hidden; text-overflow: ellipsis; }
  .sidebar-job-addr { font-size: 10px; color: #9ca3af; white-space: nowrap; overflow: hidden; text-overflow: ellipsis; }

  /* â”€â”€ Detail Panel (slides in from right inside map area) â”€â”€ */
  .detail-panel {
    position: absolute; right: 0; top: 0; bottom: 0;
    width: 340px; background: #fff;
    border-left: 1px solid #e5e7eb;
    transform: translateX(100%);
    transition: transform 0.3s cubic-bezier(0.4, 0, 0.2, 1);
    z-index: 20;
    display: flex; flex-direction: column;
    box-shadow: -3px 0 15px rgba(0,0,0,0.08);
  }
  .detail-panel.open { transform: translateX(0); }

  .dp-header {
    padding: 12px 14px; border-bottom: 1px solid #e5e7eb;
    display: flex; justify-content: space-between; align-items: flex-start;
  }
  .dp-header h3 { font-size: 15px; font-weight: 600; color: #111827; }
  .dp-header p { font-size: 12px; color: #6b7280; margin-top: 2px; line-height: 1.3; }
  .dp-close {
    background: none; border: none; cursor: pointer;
    width: 24px; height: 24px; border-radius: 4px; color: #9ca3af; font-size: 14px;
    display: flex; align-items: center; justify-content: center; flex-shrink: 0;
  }
  .dp-close:hover { background: #f3f4f6; color: #374151; }

  .dp-body { flex: 1; overflow-y: auto; padding: 12px 14px; }

  .dp-customer {
    display: flex; justify-content: space-between; align-items: flex-start;
    margin-bottom: 12px;
  }
  .dp-cust-name { font-size: 14px; font-weight: 600; color: #111827; }
  .dp-cust-phone { font-size: 12px; color: #6b7280; margin-top: 1px; }
  .dp-badge { font-size: 10px; font-weight: 500; padding: 2px 8px; border-radius: 99px; background: #dbeafe; color: #1d4ed8; }

  .dp-info { margin-bottom: 10px; }
  .dp-info-row { display: flex; align-items: flex-start; gap: 6px; font-size: 12px; color: #4b5563; margin-bottom: 6px; }
  .dp-icon { width: 14px; height: 14px; flex-shrink: 0; margin-top: 1px; color: #9ca3af; }

  .dp-divider { border-top: 1px solid #e5e7eb; margin: 10px 0; }

  .dp-form-group { margin-bottom: 10px; }
  .dp-label { font-size: 11px; font-weight: 500; color: #374151; margin-bottom: 3px; display: block; }
  .dp-select {
    width: 100%; padding: 6px 8px; font-size: 12px;
    border: 1px solid #d1d5db; border-radius: 5px; background: #fff;
  }
  .dp-tabs {
    display: flex; margin-bottom: 4px;
    border: 1px solid #d1d5db; border-radius: 5px; overflow: hidden;
  }
  .dp-tab {
    flex: 1; padding: 4px 8px; font-size: 10px; font-weight: 500;
    border: none; cursor: pointer; text-align: center;
    background: #fff; color: #6b7280;
  }
  .dp-tab.active { background: #f3f4f6; color: #111827; }

  /* Photos in detail panel */
  .dp-photos-header {
    display: flex; justify-content: space-between; align-items: center;
    margin-bottom: 6px;
  }
  .dp-photos-title { font-size: 12px; font-weight: 600; color: #111827; }
  .dp-photos-count { font-size: 10px; color: #6b7280; }
  .dp-photo-grid {
    display: grid; grid-template-columns: repeat(3, 1fr); gap: 4px;
  }
  .dp-photo {
    aspect-ratio: 1; border-radius: 4px; overflow: hidden; cursor: pointer;
    border: 1px solid #e5e7eb; position: relative;
    transition: transform 0.15s;
  }
  .dp-photo:hover { transform: scale(1.05); box-shadow: 0 2px 6px rgba(0,0,0,0.15); }
  .dp-photo img { width: 100%; height: 100%; object-fit: cover; }
  .dp-photo .photo-zoom {
    position: absolute; inset: 0; background: rgba(0,0,0,0.3);
    display: flex; align-items: center; justify-content: center;
    opacity: 0; transition: opacity 0.15s;
  }
  .dp-photo:hover .photo-zoom { opacity: 1; }
  .photo-zoom svg { width: 16px; height: 16px; color: #fff; }

  .dp-footer {
    padding: 8px 14px; border-top: 1px solid #e5e7eb;
    display: flex; gap: 6px;
  }
  .dp-btn {
    flex: 1; padding: 6px 10px; font-size: 12px; font-weight: 500;
    border-radius: 5px; cursor: pointer; border: none; text-align: center;
  }
  .dp-btn-outline { background: #fff; border: 1px solid #d1d5db; color: #374151; }
  .dp-btn-primary { background: #2563eb; color: #fff; }

  /* Map controls */
  .map-zoom {
    position: absolute; bottom: 12px; right: 12px; background: #fff;
    border-radius: 6px; box-shadow: 0 1px 4px rgba(0,0,0,0.15); overflow: hidden;
    z-index: 5;
    transition: right 0.3s ease;
  }
  .map-zoom.shifted { right: 352px; }
  .map-zoom button {
    display: block; width: 32px; height: 32px; border: none; background: #fff;
    cursor: pointer; font-size: 16px; color: #374151; border-bottom: 1px solid #e5e7eb;
  }
  .map-zoom button:last-child { border-bottom: none; }
  .map-zoom button:hover { background: #f3f4f6; }

  .map-legend {
    position: absolute; bottom: 12px; left: 12px;
    background: #fff; padding: 6px 10px; border-radius: 6px;
    box-shadow: 0 1px 4px rgba(0,0,0,0.15); font-size: 10px; z-index: 5;
  }
  .legend-row { display: flex; align-items: center; gap: 5px; margin-bottom: 3px; }
  .legend-row:last-child { margin-bottom: 0; }
  .legend-color { width: 8px; height: 8px; border-radius: 50%; }

  /* Lightbox */
  .lightbox {
    position: fixed; inset: 0; background: rgba(0,0,0,0.85);
    display: none; align-items: center; justify-content: center; z-index: 200;
  }
  .lightbox.open { display: flex; }
  .lightbox img { max-width: 85%; max-height: 80vh; border-radius: 8px; }
  .lb-close {
    position: absolute; top: 12px; right: 12px;
    background: rgba(255,255,255,0.15); border: none; color: #fff;
    width: 36px; height: 36px; border-radius: 50%; cursor: pointer; font-size: 18px;
    display: flex; align-items: center; justify-content: center;
  }
  .lb-nav {
    position: absolute; top: 50%; transform: translateY(-50%);
    background: rgba(255,255,255,0.15); border: none; color: #fff;
    width: 40px; height: 40px; border-radius: 50%; cursor: pointer; font-size: 20px;
    display: flex; align-items: center; justify-content: center;
  }
  .lb-nav.prev { left: 12px; }
  .lb-nav.next { right: 12px; }

  /* Instruction banner */
  .banner {
    position: fixed; top: 50px; left: 50%; transform: translateX(-50%);
    background: #fef3c7; color: #92400e; padding: 4px 14px;
    border-radius: 0 0 6px 6px; font-size: 11px; font-weight: 600; z-index: 50;
    box-shadow: 0 2px 6px rgba(0,0,0,0.1);
  }
</style>
</head>
<body>

<div class="banner">MOCKUP â€” Technician + Map view. Click a map pin or sidebar job to open detail panel.</div>

<!-- â•â•â• Header â•â•â• -->
<div class="header">
  <h1>Dispatch</h1>
  <div class="sep"></div>
  <div class="date-nav">
    <button>â€¹</button>
    <button>â€º</button>
    <span>Monday, February 9, 2026</span>
    <span class="day-badge">Day</span>
  </div>
  <div class="sep"></div>
  <div class="stat-dots">
    <div class="stat-dot"><div class="dot" style="background:#ef4444;"></div>2</div>
    <div class="stat-dot"><div class="dot" style="background:#3b82f6;"></div>4</div>
    <div class="stat-dot"><div class="dot" style="background:#eab308;"></div>1</div>
    <div class="stat-dot"><div class="dot" style="background:#22c55e;"></div>1</div>
  </div>
  <div class="header-right">
    <span style="font-size:12px;color:#6b7280;">View:</span>
    <button class="view-dropdown">ðŸ–¥ Technician + Map â–¾</button>
    <button class="icon-btn active" title="Map toggle">ðŸ—º</button>
    <button class="icon-btn" title="Refresh">â†»</button>
    <button class="add-btn">+ Job</button>
  </div>
</div>

<!-- â•â•â• Timeline (top half) â•â•â• -->
<div class="timeline-area" id="timelineArea">
  <!-- Tech rows with time-slotted job blocks -->
  <div style="display:flex; height:100%; overflow:hidden;">
    <!-- Tech names column -->
    <div class="tech-list" style="width:150px; flex-shrink:0; overflow-y:auto;">
      <div style="height:28px; background:#fafafa; border-bottom:1px solid #e5e7eb;"></div>
      <div class="tech-row">
        <div class="tech-avatar" style="background:#2563eb;">AR</div>
        <div class="tech-info"><div class="tech-name">Adam R.</div><div class="tech-meta">3 jobs</div></div>
      </div>
      <div class="tech-row">
        <div class="tech-avatar" style="background:#16a34a;">JS</div>
        <div class="tech-info"><div class="tech-name">John Smith</div><div class="tech-meta">2 jobs</div></div>
      </div>
      <div class="tech-row">
        <div class="tech-avatar" style="background:#dc2626;">JG</div>
        <div class="tech-info"><div class="tech-name">Jimmy G</div><div class="tech-meta">1 job</div></div>
      </div>
      <div class="tech-row">
        <div class="tech-avatar" style="background:#8b5cf6;">ST</div>
        <div class="tech-info"><div class="tech-name">Sammy T</div><div class="tech-meta">0 jobs</div></div>
      </div>
      <div class="unassigned-row" style="height:40px;">
        <div class="unassigned-dot"></div>
        <span class="unassigned-label">Unassigned</span>
        <span class="unassigned-count">2 jobs</span>
      </div>
    </div>

    <!-- Grid area with time slots -->
    <div class="grid-area" style="overflow-x:auto; overflow-y:auto;">
      <!-- Time headers -->
      <div class="time-headers">
        <div class="time-header">6am</div>
        <div class="time-header">7am</div>
        <div class="time-header">8am</div>
        <div class="time-header">9am</div>
        <div class="time-header">10am</div>
        <div class="time-header">11am</div>
        <div class="time-header">12pm</div>
        <div class="time-header">1pm</div>
        <div class="time-header">2pm</div>
        <div class="time-header">3pm</div>
        <div class="time-header">4pm</div>
        <div class="time-header">5pm</div>
      </div>
      <!-- Adam R row -->
      <div class="grid-row" style="min-width:960px;">
        <div class="job-block" style="background:#2563eb; left:80px; width:120px;" onclick="selectJob('ac')">
          <span class="job-title">AC Unit Repair</span>
          <span class="job-sub">Adam Richardson</span>
        </div>
        <div class="job-block" style="background:#2563eb; left:240px; width:80px;">
          <span class="job-title">Duct Clean</span>
          <span class="job-sub">Sarah Mitchell</span>
        </div>
        <div class="job-block" style="background:#2563eb; left:480px; width:100px;">
          <span class="job-title">Filter Replace</span>
          <span class="job-sub">David Chen</span>
        </div>
      </div>
      <!-- John S row -->
      <div class="grid-row" style="min-width:960px;">
        <div class="job-block" style="background:#16a34a; left:160px; width:100px;">
          <span class="job-title">Electrical Insp.</span>
          <span class="job-sub">David Chen</span>
        </div>
        <div class="job-block" style="background:#16a34a; left:400px; width:120px;">
          <span class="job-title">Window Repair</span>
          <span class="job-sub">Lisa Park</span>
        </div>
      </div>
      <!-- Jimmy G row -->
      <div class="grid-row" style="min-width:960px;">
        <div class="job-block" style="background:#dc2626; left:240px; width:140px;">
          <span class="job-title">Roof Inspection</span>
          <span class="job-sub">James Thompson</span>
        </div>
      </div>
      <!-- Sammy T row (empty) -->
      <div class="grid-row" style="min-width:960px;"></div>
      <!-- Unassigned -->
      <div style="display:flex; gap:4px; padding:8px; min-width:960px; height:40px; background:#fef2f2;">
        <div class="unassigned-chip">HVAC Maintenance</div>
        <div class="unassigned-chip">Garage Door Fix</div>
      </div>
    </div>
  </div>
</div>

<!-- â•â•â• Drawer Handle â•â•â• -->
<div class="drawer-handle">
  <div class="handle-bar"></div>
  <span class="handle-label">ðŸ—º Map View â€¢ 8 jobs</span>
  <div class="handle-bar"></div>
</div>

<!-- â•â•â• Map Drawer (bottom half) â•â•â• -->
<div class="map-drawer">
  <div class="map-content">
    <!-- Map canvas -->
    <div class="map-canvas" id="mapCanvas">
      <svg class="map-roads" style="position:absolute;inset:0;width:100%;height:100%;">
        <line x1="0" y1="30%" x2="100%" y2="28%" stroke="#888" stroke-width="2"/>
        <line x1="0" y1="60%" x2="100%" y2="62%" stroke="#888" stroke-width="2"/>
        <line x1="25%" y1="0" x2="27%" y2="100%" stroke="#888" stroke-width="2"/>
        <line x1="55%" y1="0" x2="52%" y2="100%" stroke="#888" stroke-width="2"/>
        <line x1="80%" y1="0" x2="78%" y2="100%" stroke="#888" stroke-width="1.5"/>
      </svg>
      <div class="area-label" style="top:15%;left:35%;">SCOTTSDALE</div>
      <div class="area-label" style="top:65%;left:55%;">TEMPE</div>
      <div class="area-label" style="top:40%;left:12%;">PHOENIX</div>

      <!-- Pins -->
      <div class="map-pin" id="pin-ac" style="top:20%;left:42%;color:#2563eb;" onclick="selectJob('ac')">
        <svg class="pin-svg" viewBox="0 0 28 34"><path d="M14 0C6.3 0 0 6.3 0 14c0 10.5 14 20 14 20s14-9.5 14-20C28 6.3 21.7 0 14 0z" fill="#2563eb"/></svg>
        <span class="pin-num">1</span>
        <div class="pin-tip">AC Unit Repair â€” Adam R.</div>
      </div>
      <div class="map-pin" id="pin-duct" style="top:35%;left:30%;color:#2563eb;" onclick="selectJob('duct')">
        <svg class="pin-svg" viewBox="0 0 28 34"><path d="M14 0C6.3 0 0 6.3 0 14c0 10.5 14 20 14 20s14-9.5 14-20C28 6.3 21.7 0 14 0z" fill="#2563eb"/></svg>
        <span class="pin-num">2</span>
        <div class="pin-tip">Duct Clean â€” Adam R.</div>
      </div>
      <div class="map-pin" style="top:55%;left:50%;color:#2563eb;">
        <svg class="pin-svg" viewBox="0 0 28 34"><path d="M14 0C6.3 0 0 6.3 0 14c0 10.5 14 20 14 20s14-9.5 14-20C28 6.3 21.7 0 14 0z" fill="#2563eb"/></svg>
        <span class="pin-num">3</span>
        <div class="pin-tip">Filter Replace â€” Adam R.</div>
      </div>
      <div class="map-pin" style="top:42%;left:62%;color:#16a34a;">
        <svg class="pin-svg" viewBox="0 0 28 34"><path d="M14 0C6.3 0 0 6.3 0 14c0 10.5 14 20 14 20s14-9.5 14-20C28 6.3 21.7 0 14 0z" fill="#16a34a"/></svg>
        <span class="pin-num">1</span>
        <div class="pin-tip">Electrical Insp. â€” John S.</div>
      </div>
      <div class="map-pin" style="top:25%;left:70%;color:#16a34a;">
        <svg class="pin-svg" viewBox="0 0 28 34"><path d="M14 0C6.3 0 0 6.3 0 14c0 10.5 14 20 14 20s14-9.5 14-20C28 6.3 21.7 0 14 0z" fill="#16a34a"/></svg>
        <span class="pin-num">2</span>
        <div class="pin-tip">Window Repair â€” John S.</div>
      </div>
      <div class="map-pin" style="top:70%;left:35%;color:#dc2626;">
        <svg class="pin-svg" viewBox="0 0 28 34"><path d="M14 0C6.3 0 0 6.3 0 14c0 10.5 14 20 14 20s14-9.5 14-20C28 6.3 21.7 0 14 0z" fill="#dc2626"/></svg>
        <span class="pin-num">1</span>
        <div class="pin-tip">Roof Inspection â€” Jimmy G.</div>
      </div>

      <!-- Map controls -->
      <div class="map-zoom" id="mapZoom">
        <button>+</button><button>âˆ’</button>
      </div>
      <div class="map-legend">
        <div class="legend-row"><div class="legend-color" style="background:#2563eb;"></div>Adam R. (3)</div>
        <div class="legend-row"><div class="legend-color" style="background:#16a34a;"></div>John S. (2)</div>
        <div class="legend-row"><div class="legend-color" style="background:#dc2626;"></div>Jimmy G. (1)</div>
        <div class="legend-row"><div class="legend-color" style="background:#6b7280;"></div>Unassigned (2)</div>
      </div>

      <!-- â•â• Detail Panel (inside map area) â•â• -->
      <div class="detail-panel" id="detailPanel">
        <div class="dp-header">
          <div>
            <h3 id="dp-title">AC Unit Repair</h3>
            <p id="dp-desc">Central AC not cooling properly. Customer reports warm air.</p>
          </div>
          <button class="dp-close" onclick="closePanel()">âœ•</button>
        </div>
        <div class="dp-body">
          <div class="dp-customer">
            <div>
              <div class="dp-cust-name">Adam Richardson</div>
              <div class="dp-cust-phone">ðŸ“ž (480) 555-1234</div>
            </div>
            <span class="dp-badge">Normal</span>
          </div>
          <div class="dp-info">
            <div class="dp-info-row">
              <svg class="dp-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M21 10c0 7-9 13-9 13s-9-6-9-13a9 9 0 0 1 18 0z"/><circle cx="12" cy="10" r="3"/></svg>
              <span>4521 E Cactus Rd, Scottsdale, AZ 85254</span>
            </div>
            <div class="dp-info-row">
              <svg class="dp-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><rect x="3" y="4" width="18" height="18" rx="2"/><line x1="16" y1="2" x2="16" y2="6"/><line x1="8" y1="2" x2="8" y2="6"/><line x1="3" y1="10" x2="21" y2="10"/></svg>
              <span>2026-02-09 at 07:00</span>
            </div>
            <div class="dp-info-row">
              <svg class="dp-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><circle cx="12" cy="12" r="10"/><polyline points="12 6 12 12 16 14"/></svg>
              <span>90 minutes</span>
            </div>
            <div class="dp-info-row">
              <svg class="dp-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"/><polyline points="14 2 14 8 20 8"/></svg>
              <span>Test job for Adam Richardson</span>
            </div>
          </div>
          <div class="dp-divider"></div>
          <div class="dp-form-group">
            <label class="dp-label">Status</label>
            <select class="dp-select"><option selected>Scheduled</option><option>In Progress</option><option>Completed</option></select>
          </div>
          <div class="dp-form-group">
            <label class="dp-label">Assigned Technician</label>
            <div class="dp-tabs"><button class="dp-tab active">Individual</button><button class="dp-tab">Crew</button></div>
            <select class="dp-select"><option>Adam Richardson</option><option>John Smith</option><option>Jimmy G</option></select>
          </div>
          <div class="dp-divider"></div>
          <div>
            <div class="dp-photos-header">
              <span class="dp-photos-title">Job Photos</span>
              <span class="dp-photos-count">5 photos</span>
            </div>
            <div class="dp-photo-grid">
              <div class="dp-photo" onclick="openLB(0)">
                <img src="https://images.unsplash.com/photo-1585771724684-38269d6639fd?w=150&h=150&fit=crop"/>
                <div class="photo-zoom"><svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><circle cx="11" cy="11" r="8"/><line x1="21" y1="21" x2="16.65" y2="16.65"/><line x1="11" y1="8" x2="11" y2="14"/><line x1="8" y1="11" x2="14" y2="11"/></svg></div>
              </div>
              <div class="dp-photo" onclick="openLB(1)">
                <img src="https://images.unsplash.com/photo-1631545806609-3c480a498e26?w=150&h=150&fit=crop"/>
                <div class="photo-zoom"><svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><circle cx="11" cy="11" r="8"/><line x1="21" y1="21" x2="16.65" y2="16.65"/><line x1="11" y1="8" x2="11" y2="14"/><line x1="8" y1="11" x2="14" y2="11"/></svg></div>
              </div>
              <div class="dp-photo" onclick="openLB(2)">
                <img src="https://images.unsplash.com/photo-1504328345606-18bbc8c9d7d1?w=150&h=150&fit=crop"/>
                <div class="photo-zoom"><svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><circle cx="11" cy="11" r="8"/><line x1="21" y1="21" x2="16.65" y2="16.65"/><line x1="11" y1="8" x2="11" y2="14"/><line x1="8" y1="11" x2="14" y2="11"/></svg></div>
              </div>
              <div class="dp-photo" onclick="openLB(3)">
                <img src="https://images.unsplash.com/photo-1621905252507-b35492cc74b4?w=150&h=150&fit=crop"/>
                <div class="photo-zoom"><svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><circle cx="11" cy="11" r="8"/><line x1="21" y1="21" x2="16.65" y2="16.65"/><line x1="11" y1="8" x2="11" y2="14"/><line x1="8" y1="11" x2="14" y2="11"/></svg></div>
              </div>
              <div class="dp-photo" onclick="openLB(4)">
                <img src="https://images.unsplash.com/photo-1558618666-fcd25c85f82e?w=150&h=150&fit=crop"/>
                <div class="photo-zoom"><svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><circle cx="11" cy="11" r="8"/><line x1="21" y1="21" x2="16.65" y2="16.65"/><line x1="11" y1="8" x2="11" y2="14"/><line x1="8" y1="11" x2="14" y2="11"/></svg></div>
              </div>
            </div>
          </div>
        </div>
        <div class="dp-footer">
          <button class="dp-btn dp-btn-outline" onclick="closePanel()">Close</button>
          <button class="dp-btn dp-btn-primary">View Full Job â†’</button>
        </div>
      </div>
    </div>

    <!-- Existing sidebar job list -->
    <div class="map-sidebar">
      <div class="sidebar-title">Today's Jobs (8)</div>
      <!-- Adam R group -->
      <div class="sidebar-group-header">
        <div class="sidebar-color" style="background:#2563eb;"></div>
        <span class="sidebar-group-name" style="color:#2563eb;">Adam R.</span>
        <span class="sidebar-group-count">3 jobs</span>
      </div>
      <div class="sidebar-job" id="sj-ac" onclick="selectJob('ac')">
        <div class="sidebar-job-num" style="background:#2563eb;">1</div>
        <div class="sidebar-job-info">
          <div class="sidebar-job-title">AC Unit Repair</div>
          <div class="sidebar-job-addr">4521 E Cactus Rd, Scottsdale</div>
        </div>
      </div>
      <div class="sidebar-job" id="sj-duct" onclick="selectJob('duct')">
        <div class="sidebar-job-num" style="background:#2563eb;">2</div>
        <div class="sidebar-job-info">
          <div class="sidebar-job-title">Duct Clean</div>
          <div class="sidebar-job-addr">1234 N Hayden Rd, Scottsdale</div>
        </div>
      </div>
      <div class="sidebar-job">
        <div class="sidebar-job-num" style="background:#2563eb;">3</div>
        <div class="sidebar-job-info">
          <div class="sidebar-job-title">Filter Replace</div>
          <div class="sidebar-job-addr">789 E Indian School, Phoenix</div>
        </div>
      </div>
      <!-- John S group -->
      <div class="sidebar-group-header">
        <div class="sidebar-color" style="background:#16a34a;"></div>
        <span class="sidebar-group-name" style="color:#16a34a;">John Smith</span>
        <span class="sidebar-group-count">2 jobs</span>
      </div>
      <div class="sidebar-job">
        <div class="sidebar-job-num" style="background:#16a34a;">1</div>
        <div class="sidebar-job-info">
          <div class="sidebar-job-title">Electrical Insp.</div>
          <div class="sidebar-job-addr">555 W Camelback Rd, Phoenix</div>
        </div>
      </div>
      <div class="sidebar-job">
        <div class="sidebar-job-num" style="background:#16a34a;">2</div>
        <div class="sidebar-job-info">
          <div class="sidebar-job-title">Window Repair</div>
          <div class="sidebar-job-addr">321 E Paradise Ln, Scottsdale</div>
        </div>
      </div>
      <!-- Jimmy G -->
      <div class="sidebar-group-header">
        <div class="sidebar-color" style="background:#dc2626;"></div>
        <span class="sidebar-group-name" style="color:#dc2626;">Jimmy G.</span>
        <span class="sidebar-group-count">1 job</span>
      </div>
      <div class="sidebar-job">
        <div class="sidebar-job-num" style="background:#dc2626;">1</div>
        <div class="sidebar-job-info">
          <div class="sidebar-job-title">Roof Inspection</div>
          <div class="sidebar-job-addr">999 S Mill Ave, Tempe</div>
        </div>
      </div>
    </div>
  </div>
</div>

<!-- Lightbox -->
<div class="lightbox" id="lightbox" onclick="closeLB()">
  <button class="lb-close" onclick="closeLB()">âœ•</button>
  <button class="lb-nav prev" onclick="event.stopPropagation(); navLB(-1)">â€¹</button>
  <img id="lb-img" src="" onclick="event.stopPropagation()" />
  <button class="lb-nav next" onclick="event.stopPropagation(); navLB(1)">â€º</button>
</div>

<script>
  const photos = [
    'https://images.unsplash.com/photo-1585771724684-38269d6639fd?w=900&h=700&fit=crop',
    'https://images.unsplash.com/photo-1631545806609-3c480a498e26?w=900&h=700&fit=crop',
    'https://images.unsplash.com/photo-1504328345606-18bbc8c9d7d1?w=900&h=700&fit=crop',
    'https://images.unsplash.com/photo-1621905252507-b35492cc74b4?w=900&h=700&fit=crop',
    'https://images.unsplash.com/photo-1558618666-fcd25c85f82e?w=900&h=700&fit=crop',
  ];
  let currentPhoto = 0;
  let panelOpen = false;

  function selectJob(id) {
    // Deselect all pins + sidebar jobs
    document.querySelectorAll('.map-pin').forEach(p => p.classList.remove('selected'));
    document.querySelectorAll('.sidebar-job').forEach(s => s.classList.remove('active'));

    // Select this pin + sidebar
    const pin = document.getElementById('pin-' + id);
    const sj = document.getElementById('sj-' + id);
    if (pin) pin.classList.add('selected');
    if (sj) sj.classList.add('active');

    // Open detail panel
    document.getElementById('detailPanel').classList.add('open');
    document.getElementById('mapCanvas').classList.add('panel-open');
    document.getElementById('mapZoom').classList.add('shifted');
    panelOpen = true;
  }

  function closePanel() {
    document.getElementById('detailPanel').classList.remove('open');
    document.getElementById('mapCanvas').classList.remove('panel-open');
    document.getElementById('mapZoom').classList.remove('shifted');
    document.querySelectorAll('.map-pin').forEach(p => p.classList.remove('selected'));
    document.querySelectorAll('.sidebar-job').forEach(s => s.classList.remove('active'));
    panelOpen = false;
  }

  function openLB(i) { currentPhoto = i; document.getElementById('lb-img').src = photos[i]; document.getElementById('lightbox').classList.add('open'); }
  function closeLB() { document.getElementById('lightbox').classList.remove('open'); }
  function navLB(d) { currentPhoto = (currentPhoto + d + photos.length) % photos.length; document.getElementById('lb-img').src = photos[currentPhoto]; }
</script>

</body>
</html>
